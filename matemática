local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local Camera = workspace.CurrentCamera

-- configurações
local fov = 9
local maxDistance = 180
local teamCheck = false

-- FOV
local FOVring = Drawing.new("Circle")
FOVring.Visible = false
FOVring.Thickness = 2
FOVring.Color = Color3.fromRGB(255, 0, 0)
FOVring.Filled = false
FOVring.Radius = fov
FOVring.Position = Camera.ViewportSize / 2

-- básico
local function updateDrawings()
    FOVring.Position = Camera.ViewportSize / 2
end

local function isPlayerAlive(player)
    local character = player.Character
    if character and character:FindFirstChild("Humanoid") then
        return character.Humanoid.Health > 0
    end
    return false
end

local function getClosestPlayerInFOV()
    local nearest = nil
    local shortestDistance = math.huge
    local centerScreen = Camera.ViewportSize / 2
    local localPlayer = Players.LocalPlayer

    for _, player in ipairs(Players:GetPlayers()) do
        if player ~= localPlayer and isPlayerAlive(player) and (not teamCheck or player.Team ~= localPlayer.Team) then
            local head = player.Character and player.Character:FindFirstChild("Head")
            if head then
                local screenPos, onScreen = Camera:WorldToViewportPoint(head.Position)
                local distance = (Vector2.new(screenPos.X, screenPos.Y) - centerScreen).Magnitude

                if onScreen and distance < fov and distance < shortestDistance then
                    shortestDistance = distance
                    nearest = player
                end
            end
        end
    end

    return nearest
end

-- click
local VirtualInputManager = game:GetService("VirtualInputManager")

local function autoMouse1()
    local targetPlayer = getClosestPlayerInFOV()
    if targetPlayer then
        -- click
        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, true, game, 0)
        wait(0.1) -- Intervalo entre cliques
        VirtualInputManager:SendMouseButtonEvent(0, 0, 0, false, game, 0)
    end
end

-- loop
RunService.RenderStepped:Connect(function()
    updateDrawings()
    local closestPlayer = getClosestPlayerInFOV()
    if closestPlayer then
        autoMouse1()
    end
end)
